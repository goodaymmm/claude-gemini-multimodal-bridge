# Claude-Gemini Multimodal Bridge (CGMB)

üöÄ **Multi-layer AI integration bridge** connecting Claude Code, Gemini CLI, and Google AI Studio for advanced multimodal processing

[![npm version](https://badge.fury.io/js/claude-gemini-multimodal-bridge.svg)](https://badge.fury.io/js/claude-gemini-multimodal-bridge)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Node.js Version](https://img.shields.io/badge/node-%3E%3D18.0.0-brightgreen)](https://nodejs.org/)

## ‚ú® Features

### üÜï **New in Latest Version (v1.0.0)**
- üöÄ **Enhanced CLI Commands**: Direct access to all AI layers without complex workflows
- ‚úÖ **Fixed Error.md Issues**: No more "unknown command" errors or timeout problems  
- üîß **Resolved AI Studio Integration**: Direct API access bypassing MCP server dependencies
- üéØ **Streamlined Gemini CLI**: Seamless search and grounding functionality
- üìä **Production-Ready**: Complete test suite, linting, and dependency verification
- üõ°Ô∏è **Improved Authentication**: Auto-fix capabilities and better error diagnostics
- ‚ö° **Real Multimodal Processing**: Actual content generation and analysis (not just initialization)

### üèóÔ∏è **Core Features**
- üîó **3-Layer Architecture**: Claude Code ‚Üî Gemini CLI ‚Üî AI Studio
- üéØ **Adaptive Execution**: Automatically routes tasks to optimal AI layer
- üìä **Multimodal Processing**: Images, Audio, PDFs, Documents
- ‚ö° **Workflow Orchestration**: Complex multi-step automation
- üõ°Ô∏è **Robust Error Handling**: Fallback strategies & retry logic
- üîß **Extensible Design**: Easy to add new layers and tools
- üí∞ **Cost Optimization**: Smart layer selection for efficiency
- üîÑ **Real-time Processing**: Streaming responses and parallel execution

## üèóÔ∏è Architecture

CGMB operates as an **MCP (Model Context Protocol) server** that seamlessly integrates three powerful AI layers. Claude Code connects to CGMB via MCP, enabling transparent enhancement of your existing workflows.

```mermaid
graph TD
    A[Claude Code CLI] --> B[MCP Connection]
    B --> C[CGMB Server]
    C --> D[Layer Manager]
    D --> E[Claude Code Layer]
    D --> F[Gemini CLI Layer]  
    D --> G[AI Studio MCP Layer]
    
    E --> H[Complex Reasoning & Workflow Orchestration]
    F --> I[Real-time Grounding & Google Search]
    G --> J[Multimodal Processing & File Conversion]
    
    H --> K[Intelligent Result Synthesis]
    I --> K
    J --> K
    
    K --> L[Enhanced Response to Claude Code]
```

### How It Works

1. **MCP Integration**: CGMB runs as an MCP server that Claude Code can connect to
2. **Transparent Enhancement**: Your existing Claude Code workflows remain unchanged
3. **Intelligent Routing**: CGMB automatically routes tasks to the optimal AI layer
4. **Unified Results**: All responses are synthesized and returned through Claude Code

### Layer Responsibilities

| Layer | Primary Functions | Best For |
|-------|------------------|----------|
| **Claude Code** | Complex reasoning, workflow orchestration, code analysis | Strategic planning, complex logic |
| **Gemini CLI** | Grounding, search, rapid processing | Real-time data, command execution |
| **AI Studio MCP** | Multimodal processing, file conversion | Images, audio, PDFs, documents |

üìñ **API Key Setup Guides:**
- [Gemini API Key Guide](https://ai.google.dev/gemini-api/docs/api-key)
- [Create AI Studio API Key](https://aistudio.google.com/app/apikey)

## üöÄ Quick Start

> **WSL Users**: Run `nvm use 22.17` before installation if you encounter version errors.

#### **Windows WSL Users**
If you're using Windows WSL and encounter Node.js version or permission issues:

```bash
# Switch to required Node.js version
nvm use 22.17  # or any 22.x version
nvm current    # Verify version
```

### ‚ú® **Automatic Installation (Recommended)**

üéâ **One-command setup** with automatic dependency resolution and MCP integration:

```bash
# Automatic installation with postinstall magic
npm install -g claude-gemini-multimodal-bridge

# That's it! The postinstall script automatically:
# ‚úÖ Installs Gemini CLI (@google/gemini-cli)
# ‚úÖ Installs AI Studio MCP Server (aistudio-mcp-server)  
# ‚úÖ Sets up Claude Code MCP integration
# ‚úÖ Creates .env template file
# ‚úÖ Verifies system requirements
```

### üîß **Interactive Setup**

After installation, run the guided authentication setup:

```bash
# Interactive authentication wizard
cgmb auth --interactive

# This will guide you through:
# 1. Gemini CLI OAuth authentication
# 2. AI Studio API key setup
# 3. Claude Code verification
# 4. MCP integration confirmation
```

### üìã **Manual Installation (If Needed)**

If automatic installation fails, you can install manually:

```bash
# Install required components
npm install -g @anthropic-ai/claude-code
npm install -g @google/gemini-cli
npm install -g aistudio-mcp-server

# Clone and build CGMB
git clone https://github.com/goodaymmm/claude-gemini-multimodal-bridge.git
cd claude-gemini-multimodal-bridge
npm install && npm run build && npm link
```

### üîë **Authentication Setup**

Get your API key from [Google AI Studio](https://aistudio.google.com/app/apikey):

```bash
# Set your API key (NEW variable name)
# Open .env file with text editor and add:
# AI_STUDIO_API_KEY=your_key_here

# Authenticate Gemini CLI (OAuth recommended)
gemini auth  # Follow browser authentication flow
```

### Prerequisites

- **Node.js** ‚â• 22.0.0 (Recommended: 22.17+)
- **Claude Code CLI** installed and configured
- **Gemini CLI** installed


**Note**: WSL environments may have multiple Node.js installations. Always use nvm to ensure the correct version.

### Authentication Requirements

#### **AI Studio (Required for Generation Features)**
- **Purpose**: Image/video/audio generation, multimodal file processing
- **Method**: API Key from Google AI Studio
- **Setup**: Get your key from [https://aistudio.google.com/app/apikey](https://aistudio.google.com/app/apikey)
- **Environment**: Set `AI_STUDIO_API_KEY` in your `.env` file

#### **Gemini CLI (Required for Real-time Features)**
- **Purpose**: Real-time search, grounding, rapid text processing
- **Method**: OAuth (Recommended) via `gemini auth` command
- **Setup**: Run `gemini auth` and follow browser authentication
- **Note**: No environment variable needed - uses OAuth token automatically

#### **Claude Code (Required for All Features)**
- **Purpose**: Complex reasoning, workflow orchestration, code analysis
- **Method**: Session authentication via `claude auth`
- **Setup**: Run `claude auth` when prompted
- **Note**: Independent authentication system

### Setup

```bash
# 1. Get API key from: https://aistudio.google.com/app/apikey
# Add to .env file:
# Open .env file with text editor and add:
# AI_STUDIO_API_KEY=your_api_key_here

# 2. Run setup wizard (creates .env configuration)
cgmb setup

# 3. Configure Claude Code MCP integration
cgmb setup-mcp
# This automatically adds CGMB as an MCP server to Claude Code

# 4. Verify everything is working
cgmb verify
# This checks system requirements, authentication, and MCP configuration

# 5. Restart Claude Code to load MCP integration
# Then use Claude Code normally with enhanced capabilities!
claude "Hello! Test the enhanced capabilities."
```

**Automated MCP Integration**: CGMB now automatically configures Claude Code's MCP settings safely without overwriting existing configurations.

## üöÄ Enhanced CLI Commands

### Direct Layer Access (NEW!)

```bash
# Direct Gemini CLI with search and grounding
cgmb gemini -p "Latest AI trends in 2024-2025" --search

# Direct AI Studio for multimodal processing  
cgmb aistudio -p "Create business infographic" -f image1.png document.pdf

# Intelligent layer routing for complex tasks
cgmb process -p "Comprehensive market analysis" -w analysis -f data.csv --strategy adaptive

# Enhanced testing with actual processing
cgmb test -p "Analyze this content" -f document.pdf --timeout 180000
```

### Key Improvements Over Previous Versions

| Issue (Error.md/Error2.md/Error3.md) | Solution |
|---------------------------------------|----------|
| ‚ùå "unknown command 'gemini-chat'" | ‚úÖ `cgmb gemini -p "question"` |
| ‚ùå Commands timeout during initialization | ‚úÖ Actual processing with results |
| ‚ùå AI Studio MCP server failures | ‚úÖ Direct API integration |
| ‚ùå Complex multi-step workflows | ‚úÖ Single command execution |
| ‚ùå No real search/grounding | ‚úÖ Built-in search functionality |

### Command Reference

| Command | Purpose | Example |
|---------|---------|---------|
| `cgmb gemini` | Direct Gemini CLI access | `cgmb gemini -p "question" --search` |
| `cgmb aistudio` | AI Studio multimodal processing | `cgmb aistudio -p "create image" -f file.txt` |
| `cgmb process` | Intelligent layer routing | `cgmb process -p "analyze" -w analysis` |
| `cgmb test` | Enhanced testing | `cgmb test -p "test prompt" -f file.pdf` |
| `cgmb verify` | System verification | `cgmb verify --fix` |

### Configuration

Copy `.env.example` to `.env` and configure:

```bash
# ===== AI Studio Authentication =====
# Required for image/video/audio generation and multimodal processing
# Get your API key from: https://aistudio.google.com/app/apikey
AI_STUDIO_API_KEY=your_ai_studio_api_key_here

# ===== Gemini CLI Authentication =====
# Primary method: OAuth (run: gemini auth)
# No API key needed - uses OAuth token automatically

# ===== Claude Code Authentication =====
# Run: claude auth (no environment variable needed)
CLAUDE_API_KEY=your_claude_api_key_here_optional  # Only if using Claude API directly

# CLI Tool Paths (Auto-detected if in PATH)
CLAUDE_CODE_PATH=/usr/local/bin/claude
GEMINI_CLI_PATH=/usr/local/bin/gemini

# Processing Options
GEMINI_MODEL=gemini-2.5-pro
DEFAULT_LAYER_PRIORITY=adaptive
ENABLE_CACHING=true
```

**‚ö†Ô∏è Migration Note**: If you're upgrading from a previous version, rename `GEMINI_API_KEY` to `AI_STUDIO_API_KEY` in your `.env` file for clarity.


## üìñ Usage

### Simple Usage with Claude Code

Once set up, CGMB enhances Claude Code transparently:

```bash
# Image generation with AI Studio (Imagen 3)
claude "Generate an image of a futuristic city"

# Document analysis with multimodal processing
claude "Analyze this image and describe what you see @image.png"
claude "Summarize this PDF document @document.pdf"

# Real-time information with Gemini grounding
claude "What are the latest developments in AI technology?"

# Complex file conversion
claude "Convert this spreadsheet to markdown format @data.xlsx"
```

**Enhanced with AI Studio Priority**: Image/video/audio generation now routes to AI Studio (Imagen 3, Veo 2) instead of Gemini 2.0 Flash for superior quality.

### Working Outside Project Directory

**Method A: Global Installation (Recommended)**
```bash
# 1. One-time setup in CGMB directory
cd /path/to/claude-gemini-multimodal-bridge
npm link

# 2. Now you can work from any directory
cd /any/project/directory
cgmb serve

# 3. Use Claude Code normally with enhanced capabilities
claude "your request"  # CGMB-enhanced processing
```

**Benefits:**
- ‚úÖ Use CGMB from any directory
- ‚úÖ No need to copy files or change directory
- ‚úÖ Global `cgmb` command available system-wide
- ‚úÖ Automatic enhancement of Claude Code workflows

### How It Works

When you use Claude Code with CGMB connected:

1. **Automatic Enhancement**: CGMB detects what type of task you're doing
2. **Smart Routing**: Routes to the best AI layer (Claude Code, Gemini CLI, or AI Studio)
3. **Transparent Results**: You get enhanced capabilities without learning new commands

### Enhanced Capabilities

| Input Type | CGMB Enhancement | Example |
|------------|------------------|---------|
| **Images** | Advanced visual analysis | `claude "Analyze this chart @chart.png"` |
| **PDFs** | Full document processing | `claude "Extract tables from @report.pdf"` |
| **Audio** | Transcription + analysis | `claude "Transcribe and summarize @meeting.mp3"` |
| **Current Info** | Real-time search | `claude "Latest news about quantum computing"` |
| **Complex Tasks** | Multi-layer processing | `claude "Compare these 3 documents @doc1.pdf @doc2.pdf @doc3.pdf"` |

### Advanced Workflow Example

```typescript
// Custom workflow definition
const workflow = {
  steps: [
    {
      id: "extract_text",
      layer: "aistudio", 
      action: "convert_pdf_to_text",
      input: { files: "@input.files" }
    },
    {
      id: "analyze_content",
      layer: "claude",
      action: "complex_analysis", 
      input: { 
        text: "@extract_text.output",
        analysis_type: "sentiment_and_themes"
      },
      dependsOn: ["extract_text"]
    },
    {
      id: "generate_summary",
      layer: "gemini",
      action: "create_summary",
      input: {
        analysis: "@analyze_content.output",
        format: "executive_summary"
      },
      dependsOn: ["analyze_content"]
    }
  ]
};
```

### Workflow Types

| Type | Description | Use Cases |
|------|-------------|-----------|
| `analysis` | Multi-layer content analysis | Research, insights, evaluation |
| `conversion` | File format conversion | PDF‚ÜíMarkdown, image processing |
| `extraction` | Data extraction from files | Tables, text, metadata |
| `generation` | Content creation | Reports, summaries, presentations |

## üìä Quota Monitoring & Management

CGMB includes comprehensive API quota monitoring to help you stay within free tier limits and avoid unexpected charges.

### Free Tier Limits (Google AI Studio)

- **Requests**: 15/minute, 1,500/day
- **Tokens**: 32,000/minute, 50,000/day

### Quota Commands

```bash
# Check current quota usage
cgmb quota-status

# Detailed quota breakdown
cgmb quota-status --detailed
```

### Automatic Quota Management

- **Pre-request Validation**: Checks quota before making API calls
- **Smart Warnings**: Alerts at 80% and 90% usage thresholds  
- **Automatic Blocking**: Prevents requests that would exceed limits
- **Reset Tracking**: Monitors daily and per-minute reset times

### Quota Status Examples

```bash
üìä Google AI Studio API Quota Status
=====================================
Tier: FREE

‚úÖ Requests (Daily): 45/1500 (3%)
   Remaining: 1455
   Reset in: 18h

‚úÖ Tokens (Daily): 12450/50000 (25%)
   Remaining: 37550

‚úÖ Overall Status: HEALTHY
```

## üõ†Ô∏è API Reference

### Core Tools

#### `multimodal_process`
Process multimodal content through the 3-layer pipeline.

```json
{
  "prompt": "string",
  "files": [{"path": "string", "type": "image|audio|pdf|document"}],
  "workflow": "analysis|conversion|extraction|generation",
  "options": {
    "layer_priority": "claude|gemini|aistudio|adaptive",
    "execution_mode": "sequential|parallel|adaptive", 
    "quality_level": "fast|balanced|quality"
  }
}
```

#### `document_analysis`
Advanced document analysis combining all layers.

```json
{
  "documents": ["string"],
  "analysis_type": "summary|comparison|extraction|translation",
  "output_requirements": "string"
}
```

#### `workflow_orchestration`
Execute complex multi-step workflows.

```json
{
  "workflow_definition": {
    "steps": [/* WorkflowStep[] */],
    "fallbackStrategies": {/* ... */}
  },
  "input_data": {/* any */},
  "execution_mode": "sequential|parallel|adaptive"
}
```

## üîß CLI Command Reference

### Core Commands

#### `cgmb serve`
Start the CGMB MCP server for integration with Claude Code.

```bash
cgmb serve                     # Start server with default settings
cgmb serve --verbose          # Enable verbose logging
cgmb serve --debug            # Enable debug logging
cgmb serve -c /path/to/.env   # Use specific configuration file
```

**Process Management:**
- Server runs continuously until manually stopped (Ctrl+C)
- Automatic graceful shutdown handling
- Environment variables loaded from multiple search paths
- Supports directory-independent execution

---

#### `cgmb setup`
Initial setup wizard for CGMB dependencies and configuration.

```bash
cgmb setup                     # Run complete setup
cgmb setup --force            # Force reinstall dependencies
```

**Setup Tasks:**
- ‚úÖ Verifies Node.js version (‚â•22.0.0)
- ‚úÖ Checks for Claude Code and Gemini CLI
- ‚úÖ Creates .env configuration file from template
- ‚úÖ Creates logs directory structure
- ‚úÖ Provides next steps guidance

---

#### `cgmb verify`
Comprehensive system verification and health check command.

```bash
cgmb verify                    # Standard verification
cgmb verify --fix             # Auto-fix authentication issues
```

**Verification Checks:**
- ‚úÖ **System Requirements**: Node.js version, dependencies
- ‚úÖ **CLI Tools**: Claude Code, Gemini CLI availability  
- ‚úÖ **Authentication**: All service authentication status
- ‚úÖ **MCP Integration**: Claude Code MCP configuration
- ‚úÖ **Server Health**: CGMB server initialization test

**Auto-Fix Features (`--fix`):**
- üîß **Authentication Repair**: Automatically runs `cgmb auth --interactive`
- üîß **Path Detection**: Helps resolve CLI tool path issues
- üîß **Configuration**: Guides through missing setup steps

**Exit Codes:**
- `0`: All checks passed, system ready
- `1`: Some checks failed, manual intervention needed

**Example Output:**
```
üîç Verifying CGMB installation and authentication...

üìã System Requirements Check:
‚úì Node.js version
‚úì Project dependencies
‚úì Claude Code CLI
‚úì Gemini CLI

üîê Authentication Verification:
‚úÖ Gemini: Authenticated
‚úÖ Claude: Authenticated  
‚úÖ Aistudio: Authenticated

üîó MCP Configuration Verification:
‚úÖ Claude Code MCP Integration: Configured
   Command: node
   Args: /path/to/cgmb/dist/index.js

üöÄ Testing server initialization...
‚úì Server initialization test passed

üéâ All verification checks passed!
‚ú® CGMB is ready to use!
üí° Try: cgmb serve
```

---

### Authentication Commands

#### `cgmb auth`
Manage authentication for all AI services.

```bash
cgmb auth                           # Full authentication setup wizard
cgmb auth --interactive            # Interactive authentication setup
cgmb auth --service gemini         # Setup specific service
cgmb auth --service aistudio       # Setup AI Studio authentication
cgmb auth --method oauth           # Use OAuth method
cgmb auth --method apikey          # Use API key method
```

**Supported Services:**
- **Gemini**: OAuth (recommended) or API key
- **AI Studio**: API key (same as Gemini)
- **Claude**: OAuth through Claude Code CLI

---

#### `cgmb auth-status`
Check authentication status for all services.

```bash
cgmb auth-status                    # Basic status check
cgmb auth-status --verbose         # Detailed authentication info
```

**Example Output:**
```
üîê Authentication Status Report

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

‚úÖ Gemini: Authenticated
   Method: oauth
   User: user@example.com
   Quota: 1450 requests remaining

‚úÖ Aistudio: Authenticated
   Method: api_key
   Plan: FREE

‚úÖ Claude: Authenticated

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Overall Status: üü¢ READY

üí° Recommendations:
   ‚Ä¢ OAuth authentication provides better quota limits
   ‚Ä¢ Consider upgrading to paid plan for higher limits
```

---

#### `cgmb setup-guide`
Display comprehensive authentication setup guide.

```bash
cgmb setup-guide               # Show step-by-step setup instructions
```

---

### MCP Integration Commands

#### `cgmb setup-mcp`
Configure Claude Code MCP integration for CGMB automatically.

```bash
cgmb setup-mcp                     # Automatic MCP configuration
cgmb setup-mcp --force            # Force update existing config
cgmb setup-mcp --dry-run          # Show what would be done
cgmb setup-mcp --manual           # Show manual setup instructions
```

**Features:**
- ‚úÖ **Safe Configuration**: Automatically backs up existing MCP settings
- ‚úÖ **Merge Strategy**: Adds CGMB without overwriting other MCP servers
- ‚úÖ **Auto-Detection**: Finds Claude Code configuration directory automatically
- ‚úÖ **Rollback Support**: Creates timestamped backups for safety

**Example Output:**
```
üîß Setting up Claude Code MCP integration...

üìä Current MCP Configuration Status
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Configuration Path: ~/.claude-code/mcp_servers.json
CGMB Configured: ‚ùå No

‚úÖ Successfully added CGMB MCP configuration
üìÅ Configuration file: ~/.claude-code/mcp_servers.json
üíæ Backup created: ~/.claude-code/mcp_servers.json.backup.2025-06-30T03-15-30-000Z

üéâ Setup Complete!

Next steps:
1. Restart Claude Code to load the new MCP configuration
2. Run "cgmb verify" to test the connection
3. Check that CGMB tools are available in Claude Code
```

---

#### `cgmb mcp-status`
Check Claude Code MCP configuration status.

```bash
cgmb mcp-status                    # Check current MCP configuration
```

**Example Output:**
```
üìä Claude Code MCP Configuration Status
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Configuration Path: ~/.claude-code/mcp_servers.json
CGMB Configured: ‚úÖ Yes

üîß Current CGMB Configuration:
   Command: node
   Arguments: /usr/local/lib/node_modules/claude-gemini-multimodal-bridge/dist/index.js
   Environment: NODE_ENV

üí° Recommendations:
   ‚Ä¢ CGMB MCP integration is properly configured
   ‚Ä¢ Consider installing CGMB globally for better performance
```

---

### Monitoring Commands

#### `cgmb quota-status`
Monitor Google AI Studio API quota usage.

```bash
cgmb quota-status                  # Basic quota status
cgmb quota-status --detailed       # Detailed quota breakdown
```

**Example Output:**
```
üìä Google AI Studio API Quota Status
=====================================
Tier: FREE

‚úÖ Requests (Daily): 45/1500 (3%)
   Remaining: 1455
   Reset in: 18h

‚úÖ Tokens (Daily): 12450/50000 (25%)
   Remaining: 37550

‚úÖ Overall Status: HEALTHY
```

---

#### `cgmb detect-paths`
Detect and verify CLI tool installations.

```bash
cgmb detect-paths                  # Detect tool paths
cgmb detect-paths --fix           # Attempt to fix PATH issues
```

---

#### `cgmb info`
Display CGMB system information.

```bash
cgmb info                          # Basic system info
cgmb info --env                   # Detailed environment info
```

---

### Testing Commands

#### `cgmb test`
Run test multimodal processing request.

```bash
cgmb test                          # Basic functionality test
cgmb test --file image.png         # Test with specific file
cgmb test --prompt "Custom prompt" # Test with custom prompt
```

## üìä Performance & Optimization

### Adaptive Layer Selection

CGMB automatically selects the optimal layer based on:

- **Task complexity**: Simple ‚Üí Gemini, Complex ‚Üí Claude
- **Content type**: Multimodal ‚Üí AI Studio, Text ‚Üí Gemini
- **Real-time needs**: Urgent ‚Üí Gemini CLI, Quality ‚Üí Claude
- **Cost considerations**: Budget-conscious routing

### Caching Strategy

```bash
# Enable intelligent caching
ENABLE_CACHING=true
CACHE_TTL=3600  # 1 hour

# Cache hit rates typically 40-60% for repeated operations
```

### Cost Optimization

- **Free Tier Usage**: Maximizes free quotas across all services
- **Smart Routing**: Routes simple tasks to free/cheaper layers
- **Batch Processing**: Combines multiple operations when possible

## üîß Advanced Configuration

### Layer-Specific Settings

```bash
# Claude Code Layer
CLAUDE_CODE_TIMEOUT=300000
CLAUDE_ENABLE_DANGEROUS_MODE=false

# Gemini CLI Layer  
GEMINI_MODEL=gemini-2.5-pro
GEMINI_TIMEOUT=60000
GEMINI_USE_SEARCH=true

# AI Studio Layer
AISTUDIO_MAX_FILES=10
AISTUDIO_MAX_FILE_SIZE=100
AISTUDIO_ENABLE_VISION=true
```

### Custom Workflows

```typescript
import { LayerManager, ExecutionPlan } from 'claude-gemini-multimodal-bridge';

const customWorkflow: ExecutionPlan = {
  steps: [
    // Your custom workflow steps
  ],
  fallbackStrategies: {
    // Fallback configurations
  }
};

const layerManager = new LayerManager(config);
const result = await layerManager.executeWorkflow(customWorkflow, inputData, options);
```

## üß™ Testing & Verification

```bash
# Verify installation and authentication
cgmb verify

# Test with real APIs
cgmb test --file example.pdf --prompt "Analyze this document"

# Check system status
cgmb info
```

## üêõ Troubleshooting

### Common Issues

**WSL Permission/Version Issues:**
```bash
# Check current Node.js version
node --version

# If version < 22.0.0, switch with nvm
nvm list        # Show available versions
nvm install 22.17  # Install if not available
nvm use 22.17   # Switch to required version

# Verify and retry
node --version
npm link
```

**"Layer not available" errors:**
```bash
# Check layer status and authentication
cgmb verify

# Check authentication status
cgmb auth-status

# Test individual layers
claude --version
gemini --help
```

**API key issues:**
```bash
# Check authentication status
cgmb auth-status --verbose

# Test Gemini API directly
gemini "test prompt"

# Verify environment variables
cgmb detect-paths
```

**Quota exceeded errors:**
```bash
# Check current quota usage
cgmb quota-status

# Wait for quota reset or upgrade plan
# Free tier resets daily
```

**Path detection issues:**
```bash
# Auto-detect CLI tool paths
cgmb detect-paths

# Fix common PATH issues
cgmb detect-paths --fix

# Manual PATH setup
export GEMINI_CLI_PATH=/usr/local/bin/gemini
export CLAUDE_CODE_PATH=/usr/local/bin/claude
```

**Performance issues:**
```bash
# Enable debug logging
LOG_LEVEL=debug cgmb serve

# Check resource usage
htop  # Monitor CPU/memory during processing

# Monitor quota usage
cgmb quota-status --detailed
```

### Debug Mode

```bash
# Enable comprehensive debugging
DEBUG=true LOG_LEVEL=debug cgmb serve --debug
```

## ü§ù Contributing

We welcome contributions! See [CONTRIBUTING.md](docs/CONTRIBUTING.md) for guidelines.

### Development Setup

```bash
git clone https://github.com/yourusername/claude-gemini-multimodal-bridge
cd claude-gemini-multimodal-bridge
npm install
npm run dev
```

### Adding New Layers

```typescript
import { LayerInterface, LayerResult } from './types';

export class MyCustomLayer implements LayerInterface {
  async initialize(): Promise<void> { /* ... */ }
  async execute(task: any): Promise<LayerResult> { /* ... */ }
  // Implement other required methods
}
```

## üìÑ License

MIT License - see [LICENSE](LICENSE) file for details.

## üôè Acknowledgments

- **Anthropic** for Claude and MCP protocol
- **Google** for Gemini models and AI Studio
- **Community contributors** for feedback and improvements

## üìû Support

- **Issues**: [GitHub Issues](https://github.com/yourusername/claude-gemini-multimodal-bridge/issues)
- **Discussions**: [GitHub Discussions](https://github.com/yourusername/claude-gemini-multimodal-bridge/discussions)
- **Documentation**: [docs/](docs/)

---